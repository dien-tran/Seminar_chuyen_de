@if (IsOpen)
{
    <div class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
        <div class="bg-white rounded-[20px] p-10 w-[538px] flex flex-col gap-6 shadow-lg">
            <div class="text-[36px] font-normal text-black leading-[26px] text-center">Enter your username</div>
            <div class="relative">
                <input @bind="@currentUsername" 
                       @bind:event="oninput"
                       @onkeypress="@OnKeyPress"
                       class="w-full px-10 py-4 rounded-lg bg-[#D9D9D9] text-[24px] text-[#878787] placeholder-[#878787] focus:outline-none" 
                       type="text" 
                       placeholder="UserName" 
                       aria-label="Username" />
            </div>
            <button class="@GetButtonClasses()" 
                    disabled="@string.IsNullOrWhiteSpace(currentUsername)"
                    @onclick="OnSubmitClick">
                OK
            </button>
        </div>
    </div>
}

@code {
    [Parameter] public bool IsOpen { get; set; }
    [Parameter] public string Username { get; set; } = string.Empty;
    [Parameter] public EventCallback<string> OnUsernameChange { get; set; }
    [Parameter] public EventCallback OnSubmit { get; set; }

    private string currentUsername = string.Empty;

    protected override void OnParametersSet()
    {
        currentUsername = Username;
    }

    private async Task OnKeyPress(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" && !string.IsNullOrWhiteSpace(currentUsername))
        {
            await OnSubmitClick();
        }
    }

    private async Task OnSubmitClick()
    {
        if (!string.IsNullOrWhiteSpace(currentUsername))
        {
            await OnUsernameChange.InvokeAsync(currentUsername);
            await OnSubmit.InvokeAsync();
        }
    }

    private string GetButtonClasses()
    {
        var baseClasses = "text-white text-[20px] font-normal rounded-lg py-2 px-20 mx-auto focus:outline-none";
        return string.IsNullOrWhiteSpace(currentUsername) 
            ? $"{baseClasses} bg-gray-400 opacity-50 cursor-not-allowed"
            : $"{baseClasses} bg-[#00B7FF] hover:opacity-90";
    }
}